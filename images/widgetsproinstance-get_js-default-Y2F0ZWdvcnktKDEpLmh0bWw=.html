
var e='';var id='';new Request.JSON({url:'/passport-getuname.html',method:'post',onComplete:function(re){if(re.uname){window.isLogin=true;$("uname_435").innerHTML=re.uname;$("memberBar_435").setStyle('display','block');if($("loginBar_435"))
$("loginBar_435").setStyle('display','none');!!$('memberBar_435').getElement('.syew')&&$('memberBar_435').getElement('.syew').setStyle('display',(re.vip_status?'':'none'));if(!!$('memberBar_435').getElement('.point'))$('memberBar_435').getElement('.point').getElement('b').innerHTML=re.point;}
else{window.isLogin=false;$("loginBar_435").setStyle('display','block');if($("memberBar_435"))
$("memberBar_435").setStyle('display','none');}},data:''}).send();var mouseover_526;var mouseout_526;JQ('#mem_h4_526').parent('li').hover(function(){clearTimeout(mouseout_526);mouseover_526=setTimeout(function(){JQ('#mem_dl_526').slideDown(200);},200);},function(){clearTimeout(mouseover_526);mouseout_526=setTimeout(function(){JQ('#mem_dl_526').slideUp(200);},200);});window.addEvent('domready',function(){var cartViewUrl='/cart-view.html';var MiniCarWidgets={init:function(){var minicart=this.cart=$('minicart_530'),minicart_detail=this.detailbox=minicart.getElement('.MiniCarDetail'),handle=this.handle=minicart.getElement('.js_minicart-title');this.attach();},display:function(){display='block';if(!!['form-cart','order-create',$$('.member-center')[0]].some(function(el){return $(el)}))display='none';this.detailbox.setStyle('display',display);return this;},attach:function(){this.cart.addEvents({'mouseenter':function(e){if(e&&this.state)retur;if(e&&$(e.target)==this.handle&&this.cart.getElement('.CartInfoItems'))
return this.show();this.request([{url:cartViewUrl,method:'post',onRequest:function(){}.bind(this)}]);this.show();}.bind(this),'mouseleave':function(e){this.hide();}.bind(this)});this.cart.addEvent('_show',function(e){this.handle.fireEvent('mouseenter');}.bind(this));window.addEvent('scroll',this.display.bind(this));},show:function(e){this.detailbox.setStyles({'visibility':'visible'});this.state=true;document.addEvent('click',function(){this.hide();document.removeEvent('click',arguments.callee);}.bind(this));},hide:function(){this.state=false;this.detailbox.setStyle('visibility','hidden');},removeCart:function(el){var cartBox=el.getParent('.minicart-single'),self=this,url=cartBox.get('urlremove');if(cartBox.hasClass('havechild')){var chlid_id=cartBox.get('chlid_id'),group;if(group=this.detailbox.getElements('.'+chlid_id)){group.each(function(ell){ell.destroy();});}}
cartBox.destroy();if(!this.detailbox.getElement('.minicart-single')){this.detailbox.getElement('.CartInfoItems').destroy();}
var _detailbox=cartBox;this.request([{url:url,data:_detailbox,onComplete:function(re){this.detailbox.innerHTML=re;var h=window.getSize().y-this.detailbox.getPosition(document.body).y+window.getScroll().y-this.detailbox.getPatch().y;this.display().addEvent();}.bind(this)}]);},removeCartActionDelete:function(el){var cartBox=el.getParent('.goods-item'),self=this,url=el.get('href');cartBox.destroy();var _detailbox=cartBox;this.request([{url:url,data:_detailbox,onComplete:function(re){this.detailbox.innerHTML=re;var h=window.getSize().y-this.detailbox.getPosition(document.body).y+window.getScroll().y-this.detailbox.getPatch().y;this.display().addEvent();if($('js_cartnum'))$('js_cartnum').innerHTML=this.detailbox.getElement('i')?this.detailbox.getElement('.minicart-info i').innerHTML:0;}.bind(this)}]);},addEvent:function(){var _this=this;this.detailbox.getElements('.delcart').addEvent('click',function(e){e.stop();_this.removeCart(this);});this.detailbox.getElements('.action-delete').addEvent('click',function(e){e.stop();_this.removeCartActionDelete(this);});},request:function(){var params=Array.flatten(arguments).link({'remoteURL':Type.isString,'options':Type.isObject});if(!params.options)return;params.options.data=(params.options.data?params.options.data.toQueryString():'')+'&mini_cart_list=true';if(!params.options.url)return false;params=Object.append({url:params.remoteURL,method:'post',onSuccess:function(re){this.detailbox.innerHTML=re;var h=window.getSize().y-this.detailbox.getPosition(document.body).y+window.getScroll().y-this.detailbox.getPatch().y;this.display().addEvent();updateCartInfo();}.bind(this)},params.options||{});return new Request(params).send();}};MiniCarWidgets.init();});new Request.JSON({url:'/passport-get_msgnum.html',method:'post',onComplete:function(re){if(re.msg_num>0){var sup=$('index_mymessage').getElement('sup');if(sup){sup.set('html',re.msg_num);}else{var supElement=new Element('sup',{html:re.msg_num});var h4=$('index_mymessage');supElement.inject($('index_mymessage'));}}},data:''}).send();function showQrCode(item){var key=JQ(item).attr('id').split('_')[JQ(item).attr('id').split('_').length-1];var qrId='#member_attention_2_qr_'+key;JQ('.member_attention_2_qr').hide();JQ(qrId).show();}
function hideQrCode(item){var key=JQ(item).attr('id').split('_')[JQ(item).attr('id').split('_').length-1];var qrId='#member_attention_2_qr_'+key;JQ(qrId).hide();}
function keepQrCodeDisplay(item){JQ('.member_attention_2_qr').hide();}
function keepQrCodeHide(item){JQ(item).hide();}
function hideAllQrCode(){JQ('.member_attention_2_qr').hide();}
function SetHome(obj){var vrl=window.location.href;try{obj.style.behavior='url(#default#homepage)';obj.setHomePage(vrl);}
catch(e){if(window.netscape){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");}
catch(e){Dialog.alert("此操作被浏览器拒绝！\n请在浏览器地址栏输入“about:config”并回车\n然后将 [signed.applets.codebase_principal_support]的值设置为'true',双击即可。");}
var prefs=Components.classes['@mozilla.org/preferences-service;1'].getService(Components.interfaces.nsIPrefBranch);prefs.setCharPref('browser.startup.homepage',vrl);}else{Dialog.alert("您的浏览器不支持，请按照下面步骤操作：1.打开浏览器设置。2.点击设置网页。3.输入："+vrl+"点击确定。");}}}
function setFavorite(obj){var sTitle=document.title;var sURL=window.location.href;(("ActiveXObject"in window)||JQ.browser.msie)?window.external.addFavorite(sURL,sTitle):(JQ.browser.mozilla?window.sidebar.addPanel(sTitle,sURL,""):Dialog.alert("您的浏览器不支持点击收藏，请按快捷键Ctrl+D收藏莎莎网"));}
window.addEvent('domready',function(){$$('#us_531 dt a').addEvents({'mouseenter':function(e){$$('#us_531 dd').setStyle('display','none');var tab=$(e.target).get('data-tab');if(!$$('#us_531 dd[data-tab='+tab+']').length)$$('#us_531').setStyle('width','86px');else $$('#us_531').setStyle('width','210px');$$('#us_531 dd[data-tab='+tab+']').setStyle('display','block');}});$$('#us_531').addEvents({'mouseleave':function(){$$('#us_531 dd').setStyle('display','none');$$('#us_531').setStyle('width','86px');}});});var mouseover_531;var mouseout_531;JQ('#us_h4_531').parent('li').hover(function(){clearTimeout(mouseout_531);mouseover_531=setTimeout(function(){JQ('#us_531').slideDown(200);},200);},function(){clearTimeout(mouseover_531);mouseout_531=setTimeout(function(){JQ('#us_531').slideUp(200);},200);});(function(scope){scope.getElement('button[type=submit]').addEvent('click',function(e){var val=scope.getElement('input').value.trim()===''?scope.getElement('input').get('placeholder'):scope.getElement('input').value.trim();if(val===''){e.stop();Dialog.alert("搜索字数太少，会影响到搜索结果，重新填写一下吧");}else{scope.getElement('input').value=val;}});var search_keywords=decodeURIComponent(Memory.get('search_key'));if(search_keywords=='null'){search_keywords='';}
var path='http://cn01.alicdn.sasa.com/public/app/b2c/statics/js/';$LAB.script(path+'autocompleter.js').wait(function(){var item=scope.getElement('[autocompleter]');var options={};try{options=JSON.decode(item.get('data-autocompleter-options'));}catch(e){}
Object.merge(options,item.retrieve('autocompleter_options',{}));Autocompleter.Request.aJSON=new Class({Extends:Autocompleter.Request.JSON,initialize:function(el,url,options){this.parent(el,options);this._hotword=new Request.JSON(Object.merge({'url':url.hotword||this.options.url,'link':'cancel'},this.options.ajaxOptions)).addEvent('onComplete',this.queryResponse.bind(this));this._suggest=new Request.JSON(Object.merge({'url':url.suggest||this.options.url,'link':'cancel'},this.options.ajaxOptions)).addEvent('onComplete',this.queryResponse.bind(this));},prefetch:function(){var value=this.element.value,query=value;if(this.options.multiple){var split=this.options.separatorSplit;var values=value.split(split);var index=this.element.getSelectedRange().start;var toIndex=value.substr(0,index).split(split);var last=toIndex.length-1;index-=toIndex[last].length;query=values[last];}
if(query.length<this.options.minLength){this.request=this._hotword;this.query();}else{this.request=this._suggest;if(this.visible&&query==this.selectedValue){if(this.visible)return false;this.showChoices();}else{this.queryValue=query;this.queryIndex=index;this.query();}}
return true;},setSelection:function(finish){var input=((this.selected.getElement('span')||this.selected).innerText||(this.selected.getElement('span')||this.selected).textContent)+'',value=input;var start=0,end=input.length;if(this.queryValue){var start=this.queryValue.length;if(input.substr(0,start).toLowerCase()!=this.queryValue.toLowerCase())start=0;}
if(this.options.multiple){var split=this.options.separatorSplit;value=this.element.value;start+=this.queryIndex;end+=this.queryIndex;var old=value.substr(this.queryIndex).split(split,1)[0];value=value.substr(0,this.queryIndex)+input+value.substr(this.queryIndex+old.length);if(finish){var tokens=value.split(this.options.separatorSplit).filter(function(entry){return this.test(entry);},/[^\s,]+/);if(!this.options.allowDupes)tokens=[].combine(tokens);var sep=this.options.separator;value=tokens.join(sep)+sep;end=value.length;}}
this.observer.setValue(value);this.opted=value;if(finish||this.selectMode=='pick')start=end;this.element.selectRange(start,end);this.fireEvent('onSelection',[this.element,this.selected,value,input]);},addChoiceEvents:function(el){return el.addEvents({'mouseenter':this.mouseOver.bind(this,el),'mousedown':this.choiceSelect.bind(this,el)});},mouseOver:function(choice,selection){if(!choice||choice==this.selected)return;if(this.selected)this.selected.removeClass('autocompleter-selected');this.selected=choice.addClass('autocompleter-selected');},onCommand:function(e){if(!e&&this.focussed)return this.prefetch();if(e&&e.key&&!e.shift){switch(e.key){case'enter':if(this.element.value!=this.opted)return true;if(this.selected&&this.visible){this.choiceSelect(this.selected);return!!(this.options.autoSubmit);}
break;case'up':case'down':if(true||this.queryValue!==null){var up=(e.key=='up');var obj=(this.selected||this.choices)[(this.selected)?((up)?'getPrevious':'getNext'):((up)?'getLast':'getFirst')]('li');if(!obj){obj=this.choices[((up)?'getLast':'getFirst')]('li');}
this.choiceOver(obj,true);}
return false;case'esc':case'tab':this.hideChoices(true);break;}}
return true;}});new Autocompleter.Request.aJSON(item,{hotword:'/search-hotword.html',suggest:'/search-suggest.html'},options);});})($('searchbar_403'));(function(){function addLeftArrow(){var category=JQ('#cat_535');category.find('.sasa_category_item').each(function(index){JQ(this).append('<div class="category_sidebox_arrow"></div>');var bias=0;index>0&&index<5?bias=index-1:bias=bias;index>=5?bias=index-2:bias=bias;JQ(this).find('.category_sidebox_arrow').css('top',index*52+17+bias+'px');});}
addLeftArrow();var obj_handle=$$('#cat_535 .sasa_category_head')||[];var obj_box=$$('#cat_535 .sasa_category')||[];if(!obj_box.length)return;var url=location.href.split('/').getLast(),n=url.lastIndexOf('-');if(n>-1)url=url.substring(0,n);if(url.indexOf('?')>=0){url=url.substring(0,url.indexOf('?'));}
if(!url.trim().length)url='index';var reg=new RegExp('^index','i');var _lastLimitTime=+new Date('Wed, 11 Nov 2015 15:59:59 GMT'),_startLimitTime=+new Date('Tue, 10 Nov 2015 16:00:00 GMT'),_lastLimitTime_t=null;function lastLimitTime1111_bindEvt(){if(obj_handle.length){obj_handle.addEvents({'mouseenter':function(e){obj_box.setStyle('visibility','visible');},'mouseleave':function(e){obj_box.setStyle('visibility','hidden');}});}
obj_box.addEvents({'mouseenter':function(e){obj_box.setStyle('visibility','visible');},'mouseleave':function(e){obj_box.setStyle('visibility','hidden');}});}
function lastLimitTime1111(){if(+new Date()>_startLimitTime&&+new Date()<_lastLimitTime){obj_box.setStyle('visibility','hidden');lastLimitTime1111_bindEvt();}else{if(url.test(reg)){obj_box.setStyle('visibility','visible');}else{lastLimitTime1111_bindEvt();}}}
lastLimitTime1111();})();(function(){})();JQ(document).ready(function(){JQ('.nav-item-more').mouseenter(function(){JQ(this).find('.nav-itembox').css('visibility','visible');});JQ('.nav-item-more').mouseleave(function(){JQ(this).find('.nav-itembox').css('visibility','hidden');});});var $el,leftPos,newWidth;var $magicLine=JQ("#magic-line");JQ("#sub_nav_420").find("li").hover
(function(){$el=JQ(this);leftPos=$el.position().left;newWidth=$el.width();$magicLine.css("display",'');$magicLine.stop().animate({left:leftPos,width:newWidth});},function(){$magicLine.stop().animate({left:$magicLine.data("origLeft"),width:$magicLine.data("origWidth")});if(JQ(".current_page_item").length>0){}else{$magicLine.css("display",'none');}});window.addEvent('resize',function(){$el=JQ(".current_page_item ");if($el.length>0){leftPos=$el.position().left;newWidth=$el.width();$magicLine.stop().animate({left:leftPos,width:newWidth});}});(function(){var url=location.href;if(!url.trim().length||url=='index.php'||url=='index')url='';var menulist=$$('#sub_nav_420 li')||[];if(menulist.length>0)
menulist.each(function(el){var obj=$(el).getElement('a');if(obj&&obj.get('href')&&((url.indexOf(obj.get('href')))>=0)){el.addClass('current_page_item');$el=JQ(el);var xleftPos=$el.position().left;var xnewWidth=$el.width();$magicLine.width(JQ(".current_page_item").width()).css("left",JQ(".current_page_item ").position().left).data("origLeft",xleftPos).data("origWidth",xnewWidth);$magicLine.stop().animate({left:xleftPos,width:xnewWidth});}else{el.removeClass('current_page_item');}});if(JQ(".current_page_item").length>0){$magicLine.width(JQ(".current_page_item").width()).css("display",'');}else{$magicLine.css("display",'none');}})();$$('.l_aone>li').addEvent('click',function(){this.toggleClass('ahover');this.getElement('span').toggleClass('active');this.getElement('.l_btwo').toggleClass('hide');});withBrowserStore(function(browserStore){var box=$('box_430');browserStore.get('history',function(v){v=JSON.decode(v);if(!v||!v.length)return;$('hst').style.display='';var html='';var template=' <li class="product-item">';template+='<a href="/product-index-{goodsId}.html" target="_blank" title="{goodsName}" inner_img="{goodsImg}" gid="{goodsId}" class="product-img">'.replace('index-','');template+='</a><div class="product-info"><div class="product-name">';template+='<a href="/product-index-{goodsId}.html" target="_blank" title="{goodsName}" >{goodsName}</a></div><div class="product-price">{actionprice}<del class="grey f12 ml10">{price}</del></div>{addcart}</div></li>'.replace('index-','');var max=Math.min(v.length,5);if(v.length>1)
v.sort(function(a,b){return b['viewTime']-a['viewTime'];});v.each(function(goods,index){goods['actionprice']=goods['actionprice'].replace('¥','').replace('￥','');goods['actionprice']='¥'+parseFloat(goods['actionprice']).toFixed(1);var vt=(+new Date()-goods['sortTime']);vt=Math.round(vt/(60*1000))+'分钟前浏览过:';if(vt.toInt()>=60){vt=Math.round(vt.toInt()/60)+'小时前浏览过:';if(vt.toInt()>23){vt=Math.round(vt.toInt()/24)+'天前浏览过:';if(vt.toInt()>3){vt=new Date(goods['viewTime']).toLocaleString()+'浏览过:';}}};if(!vt.toInt()){vt='刚才浏览了:'}
var addcart="/cart-add-goods-goods_id-goodsid-1.html";addcart=addcart.replace('goods_id',goods.goods_id);addcart=addcart.replace('goodsid',goods.goodsId);if(goods.marketable=='true'){goods.addcart="<a href="+addcart+' class="btn-scart">加入购物车</a>';}else{goods.addcart='<a href="/product-index-{goodsId}.html" class="btn-scart">查看详情</a>';}
goods['viewTime']=vt;if(index<max){if(index==max-1){goods['last']='last';}
html+=template.substitute(goods);}});var box_id='box_'+'430';new Request({url:'/product-ajax_get_product_url.html',method:'post',data:'html='+encodeURIComponent(html.trim()),onSuccess:function(res){$(box_id).set('html',res);box.getElements('.product-img').each(function(i){var imga=i.set('text','loading...');var imgsrc=imga.get('inner_img');new Asset.image(imgsrc,{onload:function(){var img=$(this);if(!img.get('src')){loadImg(imga,img,v,max);}else{if(img.$e)return;img.className='img';img.zoomImg(69,69);img.inject(imga.empty());img.$e=true;}},onerror:function(){var img=$(this);loadImg(imga,img,v,max);}});});},onFailure:function(xhr){$(box_id).set('html',html);box.getElements('.product-img').each(function(i){var imga=i.set('text','loading...');var imgsrc=imga.get('inner_img');new Asset.image(imgsrc,{onload:function(){var img=$(this);if(!img.get('src')){loadImg(imga,img,v,max);}else{if(img.$e)return;img.className='img';img.zoomImg(69,69);img.inject(imga.empty());img.$e=true;}},onerror:function(){var img=$(this);loadImg(imga,img,v,max);}});});return false;}}).send();$('box_430').set('html',html);box.getElements('.product-img').each(function(i){var imga=i.set('text','loading...');var imgsrc=imga.get('inner_img');new Asset.image(imgsrc,{onload:function(){var img=$(this);if(!img.get('src')){loadImg(imga,img,v,max);}else{if(img.$e)return;img.className='img';img.zoomImg(69,69);img.inject(imga.empty());img.$e=true;}},onerror:function(){var img=$(this);loadImg(imga,img,v,max);}});});});function loadImg(imga,img,v,max){imga.set('text','update...');var gid=imga.get('gid');new Request.JSON({url:"/product-picsJson.html",onComplete:function(data){new Asset.image(data,{onload:function(){var img=$(this);if(img.$e)return;img.zoomImg(70,70);img.inject(imga.empty());img.$e=true;},onerror:function(){imga.destroy();}});v.map(function(goods,index){if(index<max&&goods['goodsId']==gid)
return goods['goodsImg']=data;});browserStore.set('history',JSON.encode(v));}}).get({'gids':gid});}});JQ(document).ready(function(){JQ('.sidecarts-promotion-rs').mouseenter(function(){JQ('.sidecarts-promo-adv-rs').show();});JQ('.sidecarts-promotion-rs').mouseleave(function(){JQ('.sidecarts-promo-adv-rs').hide();});});~(function($){var $contMain=$('.J-updatecart');window.checkDepotState=function(cb){var $selectedChkbox=$('input[name^=J_select_goods_]:checked',$contMain),_isBondedChkbox=$selectedChkbox.hasClass('J-select-goods-bonded',$contMain),$thisDepotAllChkbox=null,$thisDepotTable=null,$thisDepotChkbox=null;if($selectedChkbox.length>0){if(_isBondedChkbox==true){$thisDepotAllChkbox=$('.J-select-goods-bonded',$contMain);}else if(_isBondedChkbox==false){$thisDepotAllChkbox=$('.J-select-goods-normal',$contMain);}
$thisDepotTable=$thisDepotAllChkbox.parents('.J-sidecart-list-wp');$thisDepotChkbox=$thisDepotTable.find('input[name=sidebar_cart_is_bonded]');$thisDepotTable.siblings('.J-sidecart-list-wp').addClass('ui-sidecart-list-wp__disabled');if(!!$thisDepotChkbox){$thisDepotChkbox[0].checked=($thisDepotAllChkbox.length===$selectedChkbox.length);}}else{!!cb&&cb();}}
var updateInterface=function(res){if(!!res.is_empty){$('#js_carttitle').trigger('click');return false;};if(!!res.sub_total){$('#J_sidecart-subtotal').html(res.sub_total.subtotal_prefilter_after)
$('#J_sidecart-totalitem').html(res.sub_total.items_total_quantity);$('#J_sidecart-selecteditem').html(res.sub_total.items_quantity);$('#js_cartnum').html(res.sub_total.items_total_quantity);checkDepotState(function(){$('input[name=sidebar_cart_is_bonded]',$contMain).each(function(index,el){el.checked=false;});$('.ui-sidecart-list-wp.ui-sidecart-list-wp__disabled',$contMain).removeClass('ui-sidecart-list-wp__disabled');});}}
var selectedGoods=function(ctx){var _ctx=ctx,$ctx=$(ctx),$p=$ctx.parents('.J-sidecart-item');_ident=$p.find('.J-sidebar-data-ident').val();$.ajax({url:'/cart-ajax_select_cart_item.html',type:'POST',data:{obj_ident:_ident,is_selected:_ctx.checked},dataType:'json',error:function(){Message.error(res.msg);return false;},success:function(res){if(res.status=='fail'){Message.error(res.msg);return false;}
_ctx.checked=!_ctx.checked;updateInterface(res,$p);}});}
var selectDepot=function(ctx){var $ctx=$(ctx),_ctxBondedState=$ctx.val(),$parents=null,$curTable=null;$.ajax({url:'/cart-ajax_batch_select_cart_item.html',type:'POST',dataType:'json',data:{is_bonded:_ctxBondedState,is_selected:$ctx[0].checked},success:function(res){if('fail'==res.status){Message.error(res.msg);return false;}
$curTable=$ctx.parents('.J-sidecart-list-wp');$parents=$curTable.find('.J-sidecart-item');$parents.find('.J-select-gooods').each(function(index,el){el.checked=!$ctx[0].checked;});$curTable.siblings('.J-sidecart-list-wp').toggleClass('ui-sidecart-list-wp__disabled',$ctx[0].checked);updateInterface(res,$parents);}});}
$(document).on('click','.J-updatecart .J-select-gooods',function(event){event.preventDefault();selectedGoods(this);}).on('click','.J-updatecart input[name=sidebar_cart_is_bonded]',function(event){event.preventDefault();selectDepot(this);}).on('click','.J-updatecart .J-cart-remove',function(e){e.preventDefault();var $ctx=$(this),_ctx=this,$cont=$ctx.parents('.J-sidecart-item'),_data=$('input[type=hidden]',$cont).serialize();$.ajax({url:'/cart-remove.html',type:'POST',dataType:'json',data:_data,success:function(res){$cont.animate({opacity:0},300,function(){$cont.remove();});updateInterface(res);}});});})(window.jQuery);var winHeight=0;function findWindowHeight(){if(window.innerHeight){winHeight=window.innerHeight;}else if((document.body)&&(document.body.clientHeight)){winHeight=document.body.clientHeight;}
if(document.documentElement&&document.documentElement.clientHeight&&document.documentElement.clientWidth){winHeight=document.documentElement.clientHeight;}
return winHeight;}
window.addEvent('domready',function(){side_animate("#mysasadiv","#mysasa",38,70);side_animate("#myfavdiv","#myfav",38,70);side_animate("#mydisdiv","#mydis",38,70);side_animate("#mysidehistorydiv","#mysidehistory",38,70);side_animate("#mysidecodediv","#mysidecode",88,120);JQ('#js_sidecart').css({'height':findWindowHeight()});JQ('#js_updatecart .sidecart-list').css({'height':findWindowHeight()-145});JQ('#js_updatecart .sidecart-totle').css({'position':'absolute'});JQ('#js_updatecart .sidecart-totle').css({'bottom':'60px'});JQ('#js_sidehistory').css({'height':findWindowHeight()});JQ('#js_sidehistory .sidecart-list').css({'height':findWindowHeight()-80});JQ('.sidecart-list').css({'maxHeight':findWindowHeight(),'overflowY':"auto"});});window.addEvent('resize',function(){JQ(".sidebar").css({'height':findWindowHeight()});JQ('#js_sidecart').css({'height':findWindowHeight()});JQ('#js_updatecart .sidecart-list').css({'height':findWindowHeight()-145});JQ('#js_updatecart .sidecart-totle').css({'position':'absolute'});JQ('#js_updatecart .sidecart-totle').css({'bottom':'60px'});JQ('#js_sidehistory').css({'height':findWindowHeight()});JQ('#js_sidehistory .sidecart-list').css({'height':findWindowHeight()-80});});function openLive800(){popup_window=window.open("http://180.167.1.42:20040/IM/HK_sasa/SaSalogin.do","","width=580,height=485,scrollbars=0,resizable=1");}
function side_animate(outdivid,movedivid,rightover,rightleft){var a=null;JQ(outdivid).hover(function(){JQ(outdivid).css('background-color','#ec3e7d');a=setTimeout(function(){JQ(movedivid).show();JQ(movedivid).animate({opacity:1,right:rightover},225,function(){a=null;});},200)},function(){JQ(outdivid).css('background-color','');clearTimeout(a);JQ(movedivid).animate({opacity:0,right:rightleft},225,function(){JQ(this).hide();});});}
var clientHeight=document.documentElement.clientHeight;JQ(".sidebar").css({'height':findWindowHeight()});new Request.HTML({url:'http://www.sasa.com/cart-ajax_getcarthtml.html',update:$('js_updatecart'),onComplete:function(){$("js_cartnum").set('html',JQ('#J_sidecart-totalitem').text()||0);JQ('#js_updatecart .sidecart-list').css({'height':findWindowHeight()-145});JQ('#js_updatecart .sidecart-totle').css({'position':'absolute'});JQ('#js_updatecart .sidecart-totle').css({'bottom':'60px'});checkDepotState();}}).send();JQ('#js_carttitle').bind('click',function(){JQ('#js_sidecart').css({'display':"block"});JQ('#js_sidehistory').css({'display':"none"});new Request.HTML({url:'http://www.sasa.com/cart-ajax_getcarthtml.html',update:$('js_updatecart'),onComplete:function(){$("js_cartnum").set('html',JQ('#J_sidecart-totalitem').text()||0);JQ('#js_updatecart .sidecart-list').css({'height':findWindowHeight()-145});JQ('#js_updatecart .sidecart-totle').css({'position':'absolute'});JQ('#js_updatecart .sidecart-totle').css({'bottom':'60px'});checkDepotState();}}).send();});JQ('.sidecart').bind('mouseleave',function(){JQ(this).css('background-color','');});JQ('.sidecart').bind('mouseover',function(){JQ(this).css('background-color','#ec3e7d');});JQ('#js_closecart').bind('click',function(){JQ('#js_sidecart').css({'display':"none"});});JQ('#js_historytitle').bind('click',function(){JQ('#js_sidehistory').css({'display':"block"});JQ('#js_sidecart').css({'display':"none"});JQ('#js_sidehistory .sidecart-list').css({'height':findWindowHeight()-80});});JQ('.sidehistory').bind('mouseleave',function(){});JQ('#js_closehistory').bind('click',function(){JQ('#js_sidehistory').css({'display':"none"});});browserStore=new BrowserStore();withBrowserStore(function(browserStore){var box=$('box_sidehistory');browserStore.get('history',function(v){v=JSON.decode(v);if(!v||!v.length)return;var html='';var template='<dl><dt>';template+='<a href="/product-index-{goodsId}.html" target="_blank" title="{goodsName}" inner_img="{goodsImg}" gid="{goodsId}" class="product-img">'.replace('index-','');template+='</a></dt><dd><h5>';template+='<a href="/product-index-{goodsId}.html" target="_blank" title="{goodsName}" class="product-name">{goodsName}</a></h5><div class="btn-price">{price}</div>{addcart}</dd></dl>'.replace('index-','');var max=Math.min(v.length,99);if(v.length>1)
v.sort(function(a,b){return b['viewTime']-a['viewTime'];});$('js_hisnum').set('html',"<a id ='clear_history'   href='javascript:void(0);' class='fr red'>清空</a>共"+v.length+"件商品");$('clear_history').addEvent('click',function(){browserStore.clear('history');$('box_sidehistory').set('html','');$('js_hisnum').set('html',"");Message.success('清除成功');$('js_sidehistory').hide();});v.each(function(goods,index){var vt=(+new Date()-goods['sortTime']);vt=Math.round(vt/(60*1000))+'分钟前浏览过:';if(vt.toInt()>=60){vt=Math.round(vt.toInt()/60)+'小时前浏览过:';if(vt.toInt()>23){vt=Math.round(vt.toInt()/24)+'天前浏览过:';if(vt.toInt()>3){vt=new Date(goods['viewTime']).toLocaleString()+'浏览过:';}}};if(!vt.toInt()){vt='刚才浏览了:'}
var addcart="/cart-add-goods-goods_id-goodsid-1.html";addcart=addcart.replace('goods_id',goods.goods_id);addcart=addcart.replace('goodsid',goods.goodsId);if(goods.marketable=='true'&&parseInt(goods.stock)>0){goods.addcart="<a href="+addcart+" class='btn-scart'   target='_dialog_minicart'>加入购物车</a>";}else{goods.addcart='<a href="/product-index-goodsId.html" class="btn-scart">查看详情</a>';goods.addcart=goods.addcart.replace('goodsId',goods.goodsId);}
goods['viewTime']=vt;if(index<max){if(index==max-1){goods['last']='last';}
html+=template.substitute(goods);}});$('box_sidehistory').set('html',html);box.getElements('.product-img').each(function(i){var imga=i.set('text','loading...');var imgsrc=imga.get('inner_img');new Asset.image(imgsrc,{onload:function(){var img=$(this);if(!img.get('src')){loadImg(imga,img,v,max);}else{if(img.$e)return;img.className='img';img.zoomImg(69,69);img.inject(imga.empty());img.$e=true;}},onerror:function(){var img=$(this);loadImg(imga,img,v,max);}});});});function loadImg(imga,img,v,max){imga.set('text','update...');var gid=imga.get('gid');new Request.JSON({url:"/product-picsJson.html",onComplete:function(data){new Asset.image(data,{onload:function(){var img=$(this);if(img.$e)return;img.zoomImg(70,70);img.inject(imga.empty());img.$e=true;},onerror:function(){imga.destroy();}});v.map(function(goods,index){if(index<max&&goods['goodsId']==gid)
return goods['goodsImg']=data;});browserStore.set('history',JSON.encode(v));}}).get({'gids':gid});}});window.addEvent('domready',function(){var linktocart=$$('a[target=_dialog_minicart], button[target=_dialog_minicart]');miniCart.init();formToCart();})
goTopEx();(function(){JQ(document).ready(function(){JQ('#footer_link_2_515').find('.footer_link_2_sep').last().remove();});})();